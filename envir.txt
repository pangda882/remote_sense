# 进入 home 目录或你希望安装的位置
cd ~

# 下载 Miniconda 安装脚本（以 Python 3.10 版本为例）
wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh

# 添加可执行权限（可选）
chmod +x Miniconda3-latest-Linux-x86_64.sh

# 运行安装脚本
bash Miniconda3-latest-Linux-x86_64.sh
# 初始化 bash，让 conda 自动把激活脚本写进 .bashrc
~/miniconda3/bin/conda init bash
echo "export CDPATH='/gemini/data-1/'" >> ~/.bashrc
source ~/.bashrc

wget https://developer.download.nvidia.com/compute/cuda/11.8.0/local_installers/cuda_11.8.0_520.61.05_linux.run
chmod +x cuda_11.8.0_520.61.05_linux.run
./cuda_11.8.0_520.61.05_linux.run --silent --toolkit
echo 'export PATH=/usr/local/cuda-11.8/bin:$PATH' >> ~/.bashrc
echo 'export LD_LIBRARY_PATH=/usr/local/cuda-11.8/lib64:$LD_LIBRARY_PATH' >> ~/.bashrc
source ~/.bashrc


conda env create -f environment.yml


conda install --yes -c pytorch pytorch=1.7.1 torchvision cudatoolkit=11.0
pip install ftfy regex tqdm
cd ../
git clone https://github.com/openai/CLIP.git
cd CLIP
pip install .

pip uninstall mmcv mmcv-full mmcv-lite
pip install mmcv==2.0.0rc4

nohup bash tools/dist_train.sh configs/0cd_ce/changeclip_sysu.py 2 --work-dir work_dirs/changeclip_sysu > resnet_sysu.log&